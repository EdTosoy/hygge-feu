import{u as b,r as h,T as F,j as i,a as R,a1 as V,F as W,K as D,N as O,Q as H,V as I,W as K,X as Q,Y as X,Z as Y}from"./index-B6cNwYG_.js";import{u as Z}from"./UseAppDispatch-ikqRfIpi.js";import{u as P}from"./UseAppSelector-Dqq9XBwt.js";import{s as q,a as z}from"./selectors-CO56ze6E.js";import{s as G}from"./selectors-wa7v8kcT.js";import{u as J}from"./useTranslation-BewvAwbW.js";const oe=()=>{const{t:w}=J(),A=b(),t=P(q),f=P(z),c=f==null?void 0:f.savedPosts,r=Z(),g=t==null?void 0:t._id,B=async()=>{try{await r(W(g)).unwrap()}catch(l){console.error(l)}},u=P(G),{toggleModal:y,setModalContent:x}=h.useContext(F),[p,m]=h.useState([]);h.useEffect(()=>{const l=u.length&&u.filter(s=>c==null?void 0:c.includes(s._id)).map(s=>({...s,showOptions:!1}));m(l||[])},[u.length,c]),h.useEffect(()=>{(async()=>{await r(D()).unwrap()})()},[]);const E=()=>p==null?void 0:p.map((l,s)=>{const{_id:o,content:N,likes:L,savedBy:C}=l,U=t?!!L.includes(t._id):!1,M=!!C.includes(t._id),v=()=>{const a=[...p];a[s].showOptions===!0?a[s].showOptions=!1:(a.map(n=>n.showOptions=!1),a[s].showOptions=!0),m(a)},k=()=>{x(i.jsx(H,{contentValue:N,postId:o})),y()},_=async()=>{await r(I({postId:o})).unwrap(),window.location.reload()},j=async a=>{const n=[...p];if(U){const d=n[s].likes.filter(e=>t&&e!==t._id);n[s].likes=d,m(n),await r(K(o)).unwrap()}else{const d=n.map(e=>e._id===a&&t?{...e,likes:[...e.likes,t._id]}:e);m(d),await r(Q(o)).unwrap()}},S=async a=>{const n=[...p];if(M){const d=n[s].savedBy.filter(e=>e!==t._id);n[s].savedBy=d,m(n),await r(X({postId:a})).unwrap(),window.location.reload()}else{const d=n.map(e=>e._id===a?{...e,savedBy:[...e.savedBy,t._id]}:e);m(d),await r(Y({postId:a})).unwrap()}},T=()=>{x(i.jsx("div",{className:"p-5",children:i.jsx(O,{post:l,handleDeletePost:_,handleEditPost:k,handleLikePost:()=>j(o),handleSavePost:()=>S(o),toggleShowOptions:v,isModalView:!0},o)})),y()};return i.jsx(O,{post:l,handleDeletePost:_,handleEditPost:k,handleLikePost:()=>j(o),handleSavePost:()=>S(o),toggleShowOptions:v,handleOnClickComment:T},o)});return h.useEffect(()=>{B()},[g]),c!=null&&c.length?i.jsx("div",{children:(u==null?void 0:u.length)>0&&E()}):i.jsxs("div",{className:"grid place-content-center mt-40 ",children:[i.jsx("h1",{className:"font-semibold text-sm  text-center ",children:w("translation.mainpage.noActivityMessage")}),i.jsx("p",{className:"text-xs w-52 text-semi-gray py-2 text-center",children:w("translation.mainpage.placeholder")}),i.jsx("div",{className:"grid place-content-center",children:i.jsx(R,{className:"py-2 text-xs px-6 my-2 rounded-full",onClick:()=>A(V),text:w("translation.button.explore"),type:"button"})})]})};export{oe as HomeFeed};
