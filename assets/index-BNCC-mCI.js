import{b as M,r as h,T as V,j as p,K as W,N as S,Q as D,V as F,W as I,X as N,Y as Q,Z as T}from"./index-B6cNwYG_.js";import{u as b}from"./UseAppDispatch-ikqRfIpi.js";import{u as _}from"./UseAppSelector-Dqq9XBwt.js";import{s as K}from"./selectors-wa7v8kcT.js";import{s as R}from"./selectors-CO56ze6E.js";function z(){const c=b(),n=_(K),l=_(R),{pathname:O}=M(),{toggleModal:w,setModalContent:m}=h.useContext(V),[r,d]=h.useState([]),f=O.split("/")[2];h.useEffect(()=>{(async()=>{await c(W()).unwrap()})()},[]),h.useEffect(()=>{const u=(n==null?void 0:n.length)&&n.map(e=>({...e,showOptions:!1})).filter(e=>e.title&&e.content.includes(f));d(u||[])},[n==null?void 0:n.length,f]);const j=()=>r==null?void 0:r.map((u,e)=>{const{_id:a,content:B,likes:L,savedBy:A}=u,E=!!L.includes(l._id),x=!!A.includes(l._id),P=()=>{const t=[...r];t[e].showOptions===!0?t[e].showOptions=!1:(t.map(o=>o.showOptions=!1),t[e].showOptions=!0),d(t)},v=()=>{m(p.jsx(D,{contentValue:B,postId:a})),w()},y=async()=>{await c(F({postId:a})).unwrap(),window.location.reload()},k=async t=>{const o=[...r];if(E){const i=o[e].likes.filter(s=>s!==l._id);o[e].likes=i,d(o),await c(I(a)).unwrap()}else{const i=o.map(s=>s._id===t?{...s,likes:[...s.likes,l._id]}:s);d(i),await c(N(a)).unwrap()}},g=async t=>{const o=[...r];if(x){const i=o[e].savedBy.filter(s=>s!==l._id);o[e].savedBy=i,d(o),await c(Q({postId:t})).unwrap()}else{const i=o.map(s=>s._id===t?{...s,savedBy:[...s.savedBy,l._id]}:s);d(i),await c(T({postId:t})).unwrap()}},C=()=>{m(p.jsx("div",{className:"p-5",children:p.jsx(S,{post:u,handleDeletePost:y,handleEditPost:v,handleLikePost:()=>k(a),handleSavePost:()=>g(a),toggleShowOptions:P,isModalView:!0},a)})),w()};return p.jsx(S,{post:u,handleDeletePost:y,handleEditPost:v,handleLikePost:()=>k(a),handleSavePost:()=>g(a),toggleShowOptions:P,handleOnClickComment:C},a)});return p.jsx("div",{children:(n==null?void 0:n.length)>0&&j()})}export{z as SearchFeed};
