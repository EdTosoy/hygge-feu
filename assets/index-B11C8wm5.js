import{r as w,T as x,j as p,a8 as C,N as g,Q as M,V as U,W as V,X as W,Y as D,Z as F}from"./index-B6cNwYG_.js";import{u as I}from"./UseAppDispatch-ikqRfIpi.js";import{u as S}from"./UseAppSelector-Dqq9XBwt.js";import{a as N}from"./selectors-wa7v8kcT.js";import{s as T}from"./selectors-CO56ze6E.js";function b(){const l=I(),i=S(N),c=S(T),{toggleModal:P,setModalContent:h}=w.useContext(x),[r,d]=w.useState([]);w.useEffect(()=>{(async()=>{await l(C()).unwrap()})()},[]),w.useEffect(()=>{const u=i.length&&i.map(a=>({...a,showOptions:!1}));d(u||[])},[i.length]);const _=()=>r==null?void 0:r.map((u,a)=>{const{_id:o,content:O,likes:j,savedBy:B}=u,A=!!j.includes(c._id),E=!!B.includes(c._id),m=()=>{const e=[...r];e[a].showOptions===!0?e[a].showOptions=!1:(e.map(t=>t.showOptions=!1),e[a].showOptions=!0),d(e)},f=()=>{h(p.jsx(M,{contentValue:O,postId:o})),P()},v=async()=>{await l(U({postId:o})).unwrap(),window.location.reload()},k=async e=>{const t=[...r];if(A){await l(V(o)).unwrap();const n=t[a].likes.filter(s=>s!==c._id);t[a].likes=n,d(t)}else{await l(W(o)).unwrap();const n=t.map(s=>s._id===e?{...s,likes:[...s.likes,c._id]}:s);d(n)}},y=async e=>{const t=[...r];if(E){const n=t[a].savedBy.filter(s=>s!==c._id);t[a].savedBy=n,d(t),await l(D({postId:e})).unwrap()}else{const n=t.map(s=>s._id===e?{...s,savedBy:[...s.savedBy,c._id]}:s);d(n),await l(F({postId:e})).unwrap()}},L=()=>{h(p.jsx("div",{className:"p-5",children:p.jsx(g,{post:u,handleDeletePost:v,handleEditPost:f,handleLikePost:()=>k(o),handleSavePost:()=>y(o),toggleShowOptions:m,isModalView:!0},o)})),P()};return p.jsx(g,{post:u,handleDeletePost:v,handleEditPost:f,handleLikePost:()=>k(o),handleSavePost:()=>y(o),toggleShowOptions:m,handleOnClickComment:L},o)});return p.jsx("div",{children:(i==null?void 0:i.length)>0&&_()})}export{b as ProfileFeed};
